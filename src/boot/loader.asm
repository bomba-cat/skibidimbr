org 0x7C00
bits 16

jmp start

image:
db 0x00, 0x00, 0x00, 0x00, 0x08, 0x87, 0x77, 0x88, 0x00, 0x00, 0x00
db 0x00, 0x00, 0x00, 0x08, 0x87, 0x77, 0x77, 0x77, 0x80, 0x00, 0x00
db 0x00, 0x88, 0x88, 0x87, 0x77, 0x77, 0x77, 0x77, 0x78, 0x88, 0x88
db 0x00, 0x87, 0x77, 0x77, 0x77, 0x88, 0x88, 0x77, 0x77, 0x78, 0x77
db 0x00, 0x88, 0x88, 0x77, 0x78, 0x88, 0x88, 0x88, 0x77, 0x78, 0x88
db 0x00, 0x88, 0x88, 0x77, 0x88, 0x77, 0x78, 0x80, 0x87, 0x78, 0x88
db 0x00, 0x88, 0x88, 0x77, 0x80, 0x88, 0x08, 0x80, 0x87, 0x78, 0x88
db 0x00, 0x08, 0x88, 0x77, 0x78, 0x80, 0x88, 0x08, 0x87, 0x78, 0x88

times 242 db 0

start:
  xor ax, ax
  mov ds, ax
  mov es, ax
  mov ss, ax
  mov sp, 0x7DFE

  mov ah, 0x00
  mov al, 0x13
  int 0x10

  mov si, image
  mov cx, 0
  mov dx, 0

drawloop:
  lodsb
  mov ah, 0x0C

  mov al, [si - 1]
  and al, 0x0F
  int 0x10
  inc cx

  cmp cx, 22
  jne skip_line_feed

  inc dx
  mov cx, 0
  jmp drawloop_continue

skip_line_feed:
  mov al, [si - 1]
  shr al, 4
  and al, 0x0F
  int 0x10
  inc cx

drawloop_continue:
  cmp cx, 22
  jne continue_drawing

  inc dx
  mov cx, 0
  cmp dx, 22
  je halt

continue_drawing:
  jmp drawloop

halt:
  hlt
  jmp halt

times 510 - ($-$$) db 0
dw 0xAA55

